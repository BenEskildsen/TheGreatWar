<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>AttackSystemDoc - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../";
</script>

<script src="../../../../js/jquery.js"></script>
<script src="../../../../js/darkfish.js"></script>

<link href="../../../../css/fonts.css" rel="stylesheet">
<link href="../../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../../../app/assets/images/minecraftia_fnt.html">minecraftia.fnt</a>
  
    <li><a href="../../../../app/assets/javascripts/application_js.html">application.js</a>
  
    <li><a href="../../../../app/assets/javascripts/client_test_js.html">client_test.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/main_js.html">main.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/GameBoard_js.html">GameBoard.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/GameGroup_js.html">GameGroup.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/UIGroup_js.html">UIGroup.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/Unit_js.html">Unit.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/UnitGroup_js.html">UnitGroup.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/prefabs/actions_js.html">actions.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/states/boot_js.html">boot.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/states/gameover_js.html">gameover.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/states/menu_js.html">menu.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/states/play_js.html">play.js</a>
  
    <li><a href="../../../../app/assets/javascripts/game/states/preload_js.html">preload.js</a>
  
    <li><a href="../../../../app/assets/javascripts/static_pages_coffee.html">static_pages.coffee</a>
  
    <li><a href="../../../../app/assets/json/tiledTest_json.html">tiledTest.json</a>
  
    <li><a href="../../../../app/assets/stylesheets/application_css.html">application.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/static_pages_scss.html">static_pages.scss</a>
  
    <li><a href="../../../../app/models/ecs/CodingPractices_txt.html">CodingPractices</a>
  
    <li><a href="../../../../app/models/ecs/READ_ME_txt.html">READ_ME</a>
  
    <li><a href="../../../../app/models/ecs/system/AttackSystemDoc_txt.html">AttackSystemDoc</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page app/models/ecs/system/AttackSystemDoc.txt">

<p>This file provides general documentation on the format of attack systems
and how to create new ones.</p>

<p>In general, the attack system consists of three main tiers:</p>

<pre class="ruby"><span class="ruby-value">1</span>. <span class="ruby-constant">Higher</span> <span class="ruby-constant">Level</span> <span class="ruby-constant">Systems</span>
<span class="ruby-value">2</span>. <span class="ruby-constant">DamageSystem</span>
<span class="ruby-value">3</span>. <span class="ruby-constant">KillSystem</span>
</pre>

<p>Let&#39;s examine each in turn starting at the bottom and moving to the
top:</p>
<ol><li>
<p><a href="../../../../KillSystem.html">KillSystem</a></p>

<pre>The KillSystem is simply responsible for checking if entities are alive
and removing dead entities from the game (entity_manager, board, etc).</pre>
</li><li>
<p><a href="../../../../DamageSystem.html">DamageSystem</a></p>

<pre>The DamageSystem is responsible for applying damage to entities. It
is simply given the entity and the damage to apply. It does not care
how the damage was determined but simply applies it. It then calls
the KillSystem to see if the entity needs to be removed.</pre>
</li><li>
<p>Higher Level Systems</p>

<pre>In short, higher level systems are responsible for calculating the damage
to an entity to be passed to the DamageSystem.

For example, the MeleeSystem is such a system. It performs
checks to make sure that the entities involved can actually attack
each other. Then, it retrieves the MeleeAttackComponent of the attacker
and then sends (attacked_entity, damage) to the DamageSystem for it to
apply the damage. Lastly, it makes the attacked entity retaliate if it
can attack and is still alive.

In short, the higher level systems handle the semantics of the attacks
and use the lower level systems to actually apply the damage.</pre>
</li></ol>

<p>Each system also returns an array describing the result. This is done to
make sending data to the frontend easier. In short, the array returned
should be of the following form:</p>

<pre class="ruby">[[<span class="ruby-identifier">information_about_result</span>], [<span class="ruby-identifier">more_info</span>], [<span class="ruby-identifier">more_info</span>]]
</pre>

<p>This will make it easier to send messages to the frontend. One would simply
need to go through each array, transform it into a message, and send it
off.</p>

<p>All systems return [] if an invalid argument is given or nothing occurs.</p>

<p>On that note, let&#39;s look at how each return result is formatted:</p>
<ol><li>
<p><a href="../../../../KillSystem.html">KillSystem</a></p>

<pre>At the moment, the system returns a result of the following:

        [[&quot;kill&quot;, entity_id, whether_entity_was_removed_from_board, owner_if_it_has_one]]

For example:

        [[&quot;kill&quot;, &quot;entity#0&quot;, true, &quot;entity#21&quot;]]</pre>
</li><li>
<p><a href="../../../../DamageSystem.html">DamageSystem</a></p>

<pre>The basic return result is:

        [[entity_damaged, entity_damaged_row, entity_damaged_col, damage_amount]]

For example:

        [[&quot;entity#1&quot;, 0, 1, 10]]

If the entity also dies, it will return

        [[entity_damaged, entity_damaged_row, entity_damaged_col, damage_amount], [kill_info]]

For example:

        [[&quot;entity#0&quot;, 0, 1, 10], [&quot;kill&quot;, &quot;entity#0&quot;, true, &quot;entity#21&quot;]]</pre>
</li><li>
<p>Higher Level <a href="../../../../System.html">System</a></p>

<pre>Higher level systems will basically be lists of DamageSystem/KillSystem
records.

There is one important note that needs to be made. The frontend needs to
know what type of attack caused damage. Hence, it is the responsibility
for the higher level system to include this.

For example, this result from the DamageSystem:

        [[&quot;entity#1&quot;, 0, 1, 10]]

would be transformed into this for the MeleeSystem:

        [[&quot;melee&quot;, &quot;attacking_entity&quot;, &quot;entity#1&quot;, 0, 1, 10]]

Each higher level attack system should add its result. The easiest way
to do this programatically is:

        (result[0].unshift attacking_entity).unshift type_of_attack if !result.empty?

where result is the return result of the DamageSystem.</pre>
</li></ol>

<p>As for two final tips:</p>

<pre>1. Always return one&#39;s results as an array of arrays:

        [[thing_one], [thing_two], [thing_three], ...]

2. array.concat is your friend

        [[thing_one]].concat [[thing_two]] =&gt; [[thing_one], [thing_two]]

        [[thing_one]].concat [] =&gt; [[thing_one]]

Hence, there is no need to have special cases for empty arrays.</pre>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

