<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class KillSystem - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="System.html">System</a>
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-update">::update</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-KillSystem">
  <h1 id="class-KillSystem" class="class">
    class KillSystem
  </h1>

  <section class="description">
    
<p>The <a href="KillSystem.html">KillSystem</a> is responsible for removing
entities from the game once they have been killed. In short, it checks to
see if damageable entities are no longer alive. If so, it removes them from
the entity manager and any hashes they might have belonged to (such as
being placed on the board, etc.)</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-update" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update</span><span
            class="method-args">(entity_manager, entity)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This function checks an entity to determine whether it has died. If so, it
removes the entity completely from the entity_manager. It removes it from
the board and then deletes its entry from the entity manager.</p>

<p>Arguments</p>

<pre class="ruby"><span class="ruby-identifier">entity_manager</span> = <span class="ruby-identifier">the</span> <span class="ruby-identifier">manager</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">entities</span>
<span class="ruby-identifier">entity</span>         = <span class="ruby-identifier">the</span> <span class="ruby-identifier">entity</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">check</span>
</pre>

<p>Returns</p>

<pre>[] if the entity can&#39;t die or is still alive
A tuple of the form if successful
   [[&quot;kill&quot;, entity_id, whether_removed_from_board, owner_if_it_has_one]]</pre>
          
          

          
          <div class="method-source-code" id="update-source">
            <pre><span class="ruby-comment"># File app/models/ecs/system/kill_system.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">entity_manager</span>, <span class="ruby-identifier">entity</span>)

        <span class="ruby-comment"># Entities that can&#39;t be damaged can&#39;t die.</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">EntityType</span>.<span class="ruby-identifier">damageable_entity?</span>(<span class="ruby-identifier">entity_manager</span>, <span class="ruby-identifier">entity</span>)
                <span class="ruby-keyword">return</span> []
        <span class="ruby-keyword">end</span>
        
        <span class="ruby-identifier">health_comp</span> = <span class="ruby-identifier">entity_manager</span>.<span class="ruby-identifier">get_components</span>(<span class="ruby-identifier">entity</span>, <span class="ruby-constant">HealthComponent</span>).<span class="ruby-identifier">first</span>
        
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">health_comp</span>.<span class="ruby-identifier">alive?</span>
                <span class="ruby-keyword">return</span> []
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">removed</span> = <span class="ruby-constant">MotionSystem</span>.<span class="ruby-identifier">remove_piece</span>(<span class="ruby-identifier">entity_manager</span>, <span class="ruby-identifier">entity</span>)
        <span class="ruby-identifier">owner</span> = <span class="ruby-keyword">nil</span>
        
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">entity_manager</span>.<span class="ruby-identifier">has_components</span>(<span class="ruby-identifier">entity</span>, [<span class="ruby-constant">OwnedComponent</span>])
                <span class="ruby-identifier">owner</span> = <span class="ruby-identifier">entity_manager</span>.<span class="ruby-identifier">get_components</span>(<span class="ruby-identifier">entity</span>, <span class="ruby-constant">OwnedComponent</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">owner</span>
        <span class="ruby-keyword">end</span>
        
        <span class="ruby-identifier">entity_manager</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">entity</span>)
        <span class="ruby-keyword">return</span> [[<span class="ruby-string">&quot;kill&quot;</span>, <span class="ruby-identifier">entity</span>, <span class="ruby-identifier">removed</span>, <span class="ruby-identifier">owner</span>]]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

